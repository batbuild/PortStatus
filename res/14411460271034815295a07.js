
/*---
/js/bs/search.js
---*/
(function(a){BS.Search={initEvents:function(){var b=a("#searchField, #headerSearchField");b.on("focus",function(c){BS.Search.onfocus(c.target);});b.on("blur",function(c){BS.Search.onblur(c.target);});b.on("keydown",function(){BS.Tooltip.hidePopup();});b.on("keypress",function(c){if(c.keyCode==13){BS.Search.go(c.shiftKey);return false;}});},installSearchField:function(){var c=a("#userPanel"),b=a("#inputIdF");if(!c.length||!b.length){return;}c=c.get(0);b=b.get(0);Element.cleanWhitespace(c);Element.cleanWhitespace(b);b.firstChild.id="headerSearchField";Element.insert(c,{bottom:"<span class='search'>"+b.innerHTML+"</span>"});b.innerHTML="";a("#headerSearchField").on("keypress paste",function(f){if(BS.Search.timer){clearTimeout(BS.Search.timer);}var d=BS.Search.getUrl();if(f.keyCode==Event.KEY_RETURN){if(f.shiftKey){document.location.href=d;}else{BS.Search.showPopup(d);}}else{if(f.keyCode==Event.KEY_ESC){return false;}else{BS.Search.timer=setTimeout(function(){BS.Search.showPopup(BS.Search.getUrl());},700);}}});},disableSearchTooltip:function(){BS.Cookie.set("n_s_h","true",60);BS.Tooltip.hidePopup();},onfocus:function(b){a(b).parent().addClass("searchFocused");},onblur:function(b){a(b).parent().removeClass("searchFocused");},go:function(d){var g=a("#searchField"),f=a("#headerSearchField"),b=a("#inputIdF"),e=a("#searchByTime");var c=window["base_uri"]+"/searchResults.html?query="+encodeURIComponent(g.length>0?g.val():f.val())+"&buildTypeId="+b.attr("data-btId")+"&byTime="+(e.length>0?e.val():false);if(d){window.open(c);}else{document.location.href=c;}},getUrl:function(){return window["base_uri"]+"/searchResults.html?query="+encodeURIComponent(a("#headerSearchField").val())+"&buildTypeId="+a("#inputIdF").attr("data-btId");},timer:null,showPopup:function(b){new BS.Popup("searchResultsPopup",{delay:0,shift:{x:-150,y:22},hideOnMouseOut:false,loadingText:"Loading search results...",url:b+"&popupMode=true",afterShowFunc:function(c){}}).showPopupNearElement("headerSearchField",{forceReload:true});},highlightResult:function(d){var c=a(d);var b;c.each(function(){var f=a(this);b=f.data("zones");if(b){b=b.split(" ");var g;if(b.length>0){g=f.find(b[0]);if(b.length>1){for(var e=1;e<b.length;e++){g.add(f.find(b[e]));}}g.find("span.pc").addClass("highlightChanges");}}});}};BS.WaitFor(function(){var b=a("#header-ready");return b.length?b.get(0):null;},BS.Search.installSearchField);a(document).ready(BS.Search.initEvents);})(jQuery);;